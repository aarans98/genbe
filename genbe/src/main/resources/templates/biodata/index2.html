<!DOCTYPE html>
<html layout:decorate="~{base}" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:th="http://www.thymeleaf.org">

<div class="row mb-2" layout:fragment="content-header">
	<div class="col-sm-6">
		<h1 class="m-0 text-dark">Biodata</h1>
	</div>
	<div class="col-sm-6">
		<ol class="breadcrumb float-sm-right">
			<li class="breadcrumb-item"><a href="#">Biodata</a></li>
			<li class="breadcrumb-item active">Kelola</li>
		</ol>
	</div>
</div>

<div class="row" layout:fragment="content-body">
	<div class="col-12">
		<div class="card">
			<div class="card-header">
				<h3 class="card-title">List Biodata</h3>
			</div>
			<!-- /.card-header -->
			<div class="card-body">
				<div class="row">
					<div class="col-sm-2">
						<form>
							<input class="form-control" id="nik" name="nik" placeholder="NIK"
								required type="text">
						</form>
					</div>
					<div class="col-sm-2">
						<button class="btn btn-primary" id="cari">Cari</button>
					</div>
				</div>
			</div>
			<div class="card-body table-responsive">
				<table class="table table-striped table-bordered table-hover nowrap"
					id="tableBiodata" style="width: 100%"></table>
			</div>
			<!-- /.card-body -->
		</div>
		<!-- /.card -->
	</div>
	<!-- /.col -->
</div>


<th:block layout:fragment="add-scripts">
	<script>
		var tableBiodata = {
			create : function() {
				// jika table tersebut datatable, maka clear and dostroy
				if ($.fn.DataTable.isDataTable('#tableBiodata')) {
					//table yg sudah dibentuk menjadi datatable harus d rebuild lagi untuk di instantiasi ulang
					$('#tableBiodata').DataTable().clear();
					$('#tableBiodata').DataTable().destroy();
				}

				$.ajax({
					url : '/person/' + $("#nik").val(),
					method : 'get',
					contentType : 'application/json',
					success : function(result) {
						console.log(result);
						$('#tableBiodata').DataTable({
							data : [ result[0].data ],
							columns : [ {
								title : "NIK",
								data : "nik"
							}, {
								title : "Nama",
								data : "name"
							}, {
								title : "Alamat",
								data : "adress"
							}, {
								title : "No. Hp",
								data : "hp"
							}, {
								title : "Tanggal Lahir",
								data : "date"
							}, {
								title : "Tempat Lahir",
								data : "tempatLahir"
							}, {
								title : "Umur",
								data : "umur"
							}, {
								title : "Pendidikan Terakhir",
								data : "pendidikan_terakhir"
							} ]
						});
					},
					error : function(err) {
						console.log(err);
					}
				});
			}
		}
	</script>
	<script>
		$("#cari").click(function() {
			tableBiodata.create();
		});
	</script>
</th:block>
</html>


